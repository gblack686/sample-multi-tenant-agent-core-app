{
  "type": "excalidraw",
  "version": 2,
  "source": "https://excalidraw.com",
  "elements": [
    {
      "id": "title",
      "type": "text",
      "x": 400,
      "y": 20,
      "width": 400,
      "height": 45,
      "text": "Bedrock Simple Chat Flow",
      "fontSize": 32,
      "fontFamily": 2,
      "textAlign": "center",
      "baseline": 32,
      "strokeColor": "#1e1e1e",
      "backgroundColor": "transparent",
      "fillStyle": "solid",
      "strokeWidth": 2,
      "roughness": 1,
      "opacity": 100,
      "seed": 1001
    },
    {
      "id": "version-info",
      "type": "text",
      "x": 400,
      "y": 70,
      "width": 400,
      "height": 20,
      "text": "v1.0.0 | Created: 2026-01-19",
      "fontSize": 12,
      "fontFamily": 2,
      "textAlign": "center",
      "baseline": 12,
      "strokeColor": "#868e96",
      "backgroundColor": "transparent",
      "fillStyle": "solid",
      "strokeWidth": 1,
      "roughness": 1,
      "opacity": 100,
      "seed": 1002
    },
    {
      "id": "subtitle",
      "type": "text",
      "x": 400,
      "y": 95,
      "width": 400,
      "height": 25,
      "text": "Non-Streaming Request/Response",
      "fontSize": 18,
      "fontFamily": 2,
      "textAlign": "center",
      "baseline": 18,
      "strokeColor": "#1971c2",
      "backgroundColor": "transparent",
      "fillStyle": "solid",
      "strokeWidth": 1,
      "roughness": 1,
      "opacity": 100,
      "seed": 1003
    },
    {
      "id": "client-box",
      "type": "rectangle",
      "x": 20,
      "y": 140,
      "width": 280,
      "height": 220,
      "strokeColor": "#1971c2",
      "backgroundColor": "#e7f5ff",
      "fillStyle": "solid",
      "strokeWidth": 2,
      "roughness": 1,
      "opacity": 100,
      "seed": 2001,
      "roundness": { "type": 3 }
    },
    {
      "id": "client-label",
      "type": "text",
      "x": 110,
      "y": 150,
      "width": 100,
      "height": 25,
      "text": "CLIENT",
      "fontSize": 18,
      "fontFamily": 2,
      "textAlign": "center",
      "baseline": 18,
      "strokeColor": "#1971c2",
      "backgroundColor": "transparent",
      "fillStyle": "solid",
      "strokeWidth": 2,
      "roughness": 1,
      "opacity": 100,
      "seed": 2002
    },
    {
      "id": "hooks-box",
      "type": "rectangle",
      "x": 40,
      "y": 185,
      "width": 240,
      "height": 35,
      "strokeColor": "#1971c2",
      "backgroundColor": "#d0ebff",
      "fillStyle": "solid",
      "strokeWidth": 1,
      "roughness": 1,
      "opacity": 100,
      "seed": 2003,
      "roundness": { "type": 3 }
    },
    {
      "id": "hooks-text",
      "type": "text",
      "x": 70,
      "y": 193,
      "width": 180,
      "height": 22,
      "text": "pages/tools/chat/hooks.js",
      "fontSize": 12,
      "fontFamily": 3,
      "textAlign": "center",
      "baseline": 16,
      "strokeColor": "#1971c2",
      "backgroundColor": "transparent",
      "fillStyle": "solid",
      "strokeWidth": 1,
      "roughness": 1,
      "opacity": 100,
      "seed": 2004
    },
    {
      "id": "client-steps",
      "type": "text",
      "x": 40,
      "y": 230,
      "width": 240,
      "height": 120,
      "text": "1. submitMessage() called\n2. Create userMessage object\n3. Save to IndexedDB\n4. POST /api/model\n\nRequest Body:\n{ model, messages, system,\n  tools, stream: false }",
      "fontSize": 12,
      "fontFamily": 2,
      "textAlign": "left",
      "baseline": 12,
      "strokeColor": "#1e1e1e",
      "backgroundColor": "transparent",
      "fillStyle": "solid",
      "strokeWidth": 1,
      "roughness": 1,
      "opacity": 100,
      "seed": 2005
    },
    {
      "id": "server-box",
      "type": "rectangle",
      "x": 340,
      "y": 140,
      "width": 280,
      "height": 220,
      "strokeColor": "#2f9e44",
      "backgroundColor": "#ebfbee",
      "fillStyle": "solid",
      "strokeWidth": 2,
      "roughness": 1,
      "opacity": 100,
      "seed": 3001,
      "roundness": { "type": 3 }
    },
    {
      "id": "server-label",
      "type": "text",
      "x": 430,
      "y": 150,
      "width": 100,
      "height": 25,
      "text": "SERVER",
      "fontSize": 18,
      "fontFamily": 2,
      "textAlign": "center",
      "baseline": 18,
      "strokeColor": "#2f9e44",
      "backgroundColor": "transparent",
      "fillStyle": "solid",
      "strokeWidth": 2,
      "roughness": 1,
      "opacity": 100,
      "seed": 3002
    },
    {
      "id": "routes-box",
      "type": "rectangle",
      "x": 360,
      "y": 185,
      "width": 240,
      "height": 35,
      "strokeColor": "#2f9e44",
      "backgroundColor": "#d3f9d8",
      "fillStyle": "solid",
      "strokeWidth": 1,
      "roughness": 1,
      "opacity": 100,
      "seed": 3003,
      "roundness": { "type": 3 }
    },
    {
      "id": "routes-text",
      "type": "text",
      "x": 410,
      "y": 193,
      "width": 140,
      "height": 22,
      "text": "routes/model.js",
      "fontSize": 12,
      "fontFamily": 3,
      "textAlign": "center",
      "baseline": 16,
      "strokeColor": "#2f9e44",
      "backgroundColor": "transparent",
      "fillStyle": "solid",
      "strokeWidth": 1,
      "roughness": 1,
      "opacity": 100,
      "seed": 3004
    },
    {
      "id": "server-steps",
      "type": "text",
      "x": 360,
      "y": 230,
      "width": 240,
      "height": 120,
      "text": "1. requireRole() - auth\n2. Check user.remaining > 0\n3. runModel(req.body)\n4. trackModelUsage()\n5. res.json(results)\n\nservices/inference.js\nservices/providers/bedrock.js",
      "fontSize": 12,
      "fontFamily": 2,
      "textAlign": "left",
      "baseline": 12,
      "strokeColor": "#1e1e1e",
      "backgroundColor": "transparent",
      "fillStyle": "solid",
      "strokeWidth": 1,
      "roughness": 1,
      "opacity": 100,
      "seed": 3005
    },
    {
      "id": "aws-box",
      "type": "rectangle",
      "x": 660,
      "y": 140,
      "width": 280,
      "height": 220,
      "strokeColor": "#f08c00",
      "backgroundColor": "#fff9db",
      "fillStyle": "solid",
      "strokeWidth": 2,
      "roughness": 1,
      "opacity": 100,
      "seed": 4001,
      "roundness": { "type": 3 }
    },
    {
      "id": "aws-label",
      "type": "text",
      "x": 730,
      "y": 150,
      "width": 140,
      "height": 25,
      "text": "AWS BEDROCK",
      "fontSize": 18,
      "fontFamily": 2,
      "textAlign": "center",
      "baseline": 18,
      "strokeColor": "#f08c00",
      "backgroundColor": "transparent",
      "fillStyle": "solid",
      "strokeWidth": 2,
      "roughness": 1,
      "opacity": 100,
      "seed": 4002
    },
    {
      "id": "bedrock-endpoint",
      "type": "rectangle",
      "x": 680,
      "y": 185,
      "width": 240,
      "height": 35,
      "strokeColor": "#f08c00",
      "backgroundColor": "#ffec99",
      "fillStyle": "solid",
      "strokeWidth": 1,
      "roughness": 1,
      "opacity": 100,
      "seed": 4003,
      "roundness": { "type": 3 }
    },
    {
      "id": "bedrock-endpoint-text",
      "type": "text",
      "x": 690,
      "y": 193,
      "width": 220,
      "height": 22,
      "text": "bedrock-runtime.{region}.amazonaws.com",
      "fontSize": 10,
      "fontFamily": 3,
      "textAlign": "center",
      "baseline": 16,
      "strokeColor": "#f08c00",
      "backgroundColor": "transparent",
      "fillStyle": "solid",
      "strokeWidth": 1,
      "roughness": 1,
      "opacity": 100,
      "seed": 4004
    },
    {
      "id": "aws-response",
      "type": "text",
      "x": 680,
      "y": 230,
      "width": 240,
      "height": 120,
      "text": "ConverseCommand\n\nResponse:\n{\n  output.message.content,\n  stopReason: \"end_turn\",\n  usage: {\n    inputTokens, outputTokens\n  }\n}",
      "fontSize": 12,
      "fontFamily": 2,
      "textAlign": "left",
      "baseline": 12,
      "strokeColor": "#1e1e1e",
      "backgroundColor": "transparent",
      "fillStyle": "solid",
      "strokeWidth": 1,
      "roughness": 1,
      "opacity": 100,
      "seed": 4005
    },
    {
      "id": "db-box",
      "type": "rectangle",
      "x": 340,
      "y": 400,
      "width": 280,
      "height": 140,
      "strokeColor": "#7950f2",
      "backgroundColor": "#f3f0ff",
      "fillStyle": "solid",
      "strokeWidth": 2,
      "roughness": 1,
      "opacity": 100,
      "seed": 5001,
      "roundness": { "type": 3 }
    },
    {
      "id": "db-label",
      "type": "text",
      "x": 420,
      "y": 410,
      "width": 120,
      "height": 25,
      "text": "DATABASE",
      "fontSize": 18,
      "fontFamily": 2,
      "textAlign": "center",
      "baseline": 18,
      "strokeColor": "#7950f2",
      "backgroundColor": "transparent",
      "fillStyle": "solid",
      "strokeWidth": 2,
      "roughness": 1,
      "opacity": 100,
      "seed": 5002
    },
    {
      "id": "db-content",
      "type": "text",
      "x": 360,
      "y": 445,
      "width": 240,
      "height": 85,
      "text": "PostgreSQL\n\nUsage Table:\n- userId, modelId\n- inputTokens, outputTokens\n- cost",
      "fontSize": 12,
      "fontFamily": 2,
      "textAlign": "left",
      "baseline": 12,
      "strokeColor": "#1e1e1e",
      "backgroundColor": "transparent",
      "fillStyle": "solid",
      "strokeWidth": 1,
      "roughness": 1,
      "opacity": 100,
      "seed": 5003
    },
    {
      "id": "arrow1",
      "type": "arrow",
      "x": 305,
      "y": 200,
      "width": 30,
      "height": 0,
      "strokeColor": "#1e1e1e",
      "backgroundColor": "transparent",
      "fillStyle": "solid",
      "strokeWidth": 2,
      "roughness": 1,
      "opacity": 100,
      "seed": 6001,
      "points": [[0, 0], [30, 0]],
      "startArrowhead": null,
      "endArrowhead": "arrow"
    },
    {
      "id": "arrow1-label",
      "type": "text",
      "x": 300,
      "y": 175,
      "width": 50,
      "height": 20,
      "text": "POST",
      "fontSize": 10,
      "fontFamily": 2,
      "textAlign": "center",
      "baseline": 10,
      "strokeColor": "#868e96",
      "backgroundColor": "transparent",
      "fillStyle": "solid",
      "strokeWidth": 1,
      "roughness": 1,
      "opacity": 100,
      "seed": 6002
    },
    {
      "id": "arrow2",
      "type": "arrow",
      "x": 625,
      "y": 200,
      "width": 30,
      "height": 0,
      "strokeColor": "#1e1e1e",
      "backgroundColor": "transparent",
      "fillStyle": "solid",
      "strokeWidth": 2,
      "roughness": 1,
      "opacity": 100,
      "seed": 6003,
      "points": [[0, 0], [30, 0]],
      "startArrowhead": null,
      "endArrowhead": "arrow"
    },
    {
      "id": "arrow2-label",
      "type": "text",
      "x": 610,
      "y": 175,
      "width": 60,
      "height": 20,
      "text": "AWS SDK",
      "fontSize": 10,
      "fontFamily": 2,
      "textAlign": "center",
      "baseline": 10,
      "strokeColor": "#868e96",
      "backgroundColor": "transparent",
      "fillStyle": "solid",
      "strokeWidth": 1,
      "roughness": 1,
      "opacity": 100,
      "seed": 6004
    },
    {
      "id": "arrow3",
      "type": "arrow",
      "x": 655,
      "y": 280,
      "width": 30,
      "height": 0,
      "strokeColor": "#1e1e1e",
      "backgroundColor": "transparent",
      "fillStyle": "solid",
      "strokeWidth": 2,
      "roughness": 1,
      "opacity": 100,
      "seed": 6005,
      "points": [[0, 0], [-30, 0]],
      "startArrowhead": null,
      "endArrowhead": "arrow"
    },
    {
      "id": "arrow3-label",
      "type": "text",
      "x": 610,
      "y": 290,
      "width": 70,
      "height": 20,
      "text": "Response",
      "fontSize": 10,
      "fontFamily": 2,
      "textAlign": "center",
      "baseline": 10,
      "strokeColor": "#868e96",
      "backgroundColor": "transparent",
      "fillStyle": "solid",
      "strokeWidth": 1,
      "roughness": 1,
      "opacity": 100,
      "seed": 6006
    },
    {
      "id": "arrow4",
      "type": "arrow",
      "x": 335,
      "y": 280,
      "width": 30,
      "height": 0,
      "strokeColor": "#1e1e1e",
      "backgroundColor": "transparent",
      "fillStyle": "solid",
      "strokeWidth": 2,
      "roughness": 1,
      "opacity": 100,
      "seed": 6007,
      "points": [[0, 0], [-30, 0]],
      "startArrowhead": null,
      "endArrowhead": "arrow"
    },
    {
      "id": "arrow4-label",
      "type": "text",
      "x": 290,
      "y": 290,
      "width": 60,
      "height": 20,
      "text": "JSON",
      "fontSize": 10,
      "fontFamily": 2,
      "textAlign": "center",
      "baseline": 10,
      "strokeColor": "#868e96",
      "backgroundColor": "transparent",
      "fillStyle": "solid",
      "strokeWidth": 1,
      "roughness": 1,
      "opacity": 100,
      "seed": 6008
    },
    {
      "id": "arrow5",
      "type": "arrow",
      "x": 480,
      "y": 365,
      "width": 0,
      "height": 30,
      "strokeColor": "#1e1e1e",
      "backgroundColor": "transparent",
      "fillStyle": "solid",
      "strokeWidth": 2,
      "roughness": 1,
      "opacity": 100,
      "seed": 6009,
      "points": [[0, 0], [0, 30]],
      "startArrowhead": null,
      "endArrowhead": "arrow"
    },
    {
      "id": "arrow5-label",
      "type": "text",
      "x": 490,
      "y": 372,
      "width": 100,
      "height": 20,
      "text": "trackModelUsage",
      "fontSize": 10,
      "fontFamily": 2,
      "textAlign": "left",
      "baseline": 10,
      "strokeColor": "#868e96",
      "backgroundColor": "transparent",
      "fillStyle": "solid",
      "strokeWidth": 1,
      "roughness": 1,
      "opacity": 100,
      "seed": 6010
    }
  ],
  "appState": {
    "gridSize": null,
    "viewBackgroundColor": "#ffffff"
  },
  "files": {}
}
